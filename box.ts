declare var require: any
const fs = require("fs");
import { HmacSHA256, enc } from "crypto-js";
import Decimal from "decimal.js";
import { randomBytes } from "crypto";

const platinum_prob_choice:{[n:string]:{[index:string]:number}}={"1":{"0":0.0005,"1":0.00114,"2":0.00186,"3":0.00346,"4":0.00696,"5":0.04696,"6":0.08696,"7":0.17696,"8":0.29696,"9":0.49696,"10":0.72696,"11":1.0},"2":{"0":0.0,"1":0.00007,"2":0.00022,"3":0.00125,"4":0.00418,"5":0.04361,"6":0.08304,"7":0.17247,"8":0.2919,"9":0.49133,"10":0.72076,"11":1.0},"3":{"0":0.0,"1":0.0,"2":0.00008,"3":0.00104,"4":0.0039,"5":0.04326,"6":0.08262,"7":0.17198,"8":0.29134,"9":0.4907,"10":0.72006,"11":1.0},"4":{"0":0.0,"1":0.0,"2":0.0000533333,"3":0.0009866667,"4":0.00382,"5":0.0431533333,"6":0.0824866667,"7":0.17182,"8":0.2911533333,"9":0.4904866667,"10":0.71982,"11":1.0},"5":{"0":0.0,"1":0.0,"2":0.0000266667,"3":0.0009333333,"4":0.00374,"5":0.0430466667,"6":0.0823533333,"7":0.17166,"8":0.2909666667,"9":0.4902733333,"10":0.71958,"11":1.0},"6":{"0":0.0,"1":0.0,"2":0.0,"3":0.00088,"4":0.00366,"5":0.04294,"6":0.08222,"7":0.1715,"8":0.29078,"9":0.49006,"10":0.71934,"11":1.0},"7":{"0":0.0,"1":0.0,"2":0.0,"3":0.00066,"4":0.00322,"5":0.04228,"6":0.08134,"7":0.1704,"8":0.28946,"9":0.48852,"10":0.71758,"11":1.0},"8":{"0":0.0,"1":0.0,"2":0.0,"3":0.00044,"4":0.00278,"5":0.04162,"6":0.08046,"7":0.1693,"8":0.28814,"9":0.48698,"10":0.71582,"11":1.0},"9":{"0":0.0,"1":0.0,"2":0.0,"3":0.00022,"4":0.00234,"5":0.04096,"6":0.07958,"7":0.1682,"8":0.28682,"9":0.48544,"10":0.71406,"11":1.0},"10":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0019,"5":0.0403,"6":0.0787,"7":0.1671,"8":0.2855,"9":0.4839,"10":0.7123,"11":1.0},"11":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.00152,"5":0.03954,"6":0.07756,"7":0.16558,"8":0.2836,"9":0.48162,"10":0.70964,"11":1.0},"12":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.00114,"5":0.03878,"6":0.07642,"7":0.16406,"8":0.2817,"9":0.47934,"10":0.70698,"11":1.0},"13":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.00076,"5":0.03802,"6":0.07528,"7":0.16254,"8":0.2798,"9":0.47706,"10":0.70432,"11":1.0},"14":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.00038,"5":0.03726,"6":0.07414,"7":0.16102,"8":0.2779,"9":0.47478,"10":0.70166,"11":1.0},"15":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0365,"6":0.073,"7":0.1595,"8":0.276,"9":0.4725,"10":0.699,"11":1.0},"16":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0292,"6":0.0584,"7":0.1376,"8":0.2468,"9":0.436,"10":0.6552,"11":1.0},"17":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0219,"6":0.0438,"7":0.1157,"8":0.2176,"9":0.3995,"10":0.6114,"11":1.0},"18":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0146,"6":0.0292,"7":0.0938,"8":0.1884,"9":0.363,"10":0.5676,"11":1.0},"19":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0073,"6":0.0146,"7":0.0719,"8":0.1592,"9":0.3265,"10":0.5238,"11":1.0},"20":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.05,"8":0.13,"9":0.29,"10":0.48,"11":1.0},"21":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.05,"8":0.13,"9":0.29,"10":0.48,"11":1.0},"22":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.05,"8":0.13,"9":0.29,"10":0.48,"11":1.0},"23":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.05,"8":0.13,"9":0.29,"10":0.48,"11":1.0},"24":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.05,"8":0.13,"9":0.29,"10":0.48,"11":1.0},"25":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.05,"8":0.13,"9":0.29,"10":0.48,"11":1.0},"26":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.04,"8":0.11,"9":0.26,"10":0.44,"11":1.0},"27":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.03,"8":0.09,"9":0.23,"10":0.4,"11":1.0},"28":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.02,"8":0.07,"9":0.2,"10":0.36,"11":1.0},"29":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.01,"8":0.05,"9":0.17,"10":0.32,"11":1.0},"30":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.03,"9":0.14,"10":0.28,"11":1.0},"31":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.027,"9":0.134,"10":0.271,"11":1.0},"32":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.024,"9":0.128,"10":0.262,"11":1.0},"33":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.021,"9":0.122,"10":0.253,"11":1.0},"34":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.018,"9":0.116,"10":0.244,"11":1.0},"35":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.015,"9":0.11,"10":0.235,"11":1.0},"36":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.012,"9":0.104,"10":0.226,"11":1.0},"37":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.009,"9":0.098,"10":0.217,"11":1.0},"38":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.006,"9":0.092,"10":0.208,"11":1.0},"39":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.003,"9":0.086,"10":0.199,"11":1.0},"40":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.08,"10":0.19,"11":1.0},"41":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.072,"10":0.174,"11":1.0},"42":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.064,"10":0.158,"11":1.0},"43":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.056,"10":0.142,"11":1.0},"44":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.048,"10":0.126,"11":1.0},"45":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.04,"10":0.11,"11":1.0},"46":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.032,"10":0.094,"11":1.0},"47":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.024,"10":0.078,"11":1.0},"48":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.016,"10":0.062,"11":1.0},"49":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.008,"10":0.046,"11":1.0},"50":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.03,"11":1.0},"51":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.028,"11":1.0},"52":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.026,"11":1.0},"53":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.024,"11":1.0},"54":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.022,"11":1.0},"55":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.02,"11":1.0},"56":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.018,"11":1.0},"57":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.016,"11":1.0},"58":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.014,"11":1.0},"59":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.012,"11":1.0},"60":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.01,"11":1.0},"61":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.008,"11":1.0},"62":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.006,"11":1.0},"63":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.004,"11":1.0},"64":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.002,"11":1.0},"65":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":1.0},"66":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":1.0},"67":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":1.0},"68":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":1.0}}



const diamond_prob_choice:{[n:string]:{[index:string]:number}}={"1":{"0":0.001,"1":0.0023,"2":0.0038,"3":0.0073,"4":0.0123,"5":0.0183,"6":0.0683,"7":0.1683,"8":0.3083,"9":0.5083,"10":0.7383,"11":1.0},"2":{"0":0.0,"1":0.00015,"2":0.0005,"3":0.00285,"4":0.0067,"5":0.01155,"6":0.0604,"7":0.15925,"8":0.2981,"9":0.49695,"10":0.7258,"11":1.0},"3":{"0":0.0,"1":0.0,"2":0.0002,"3":0.0024,"4":0.0061,"5":0.0108,"6":0.0595,"7":0.1582,"8":0.2969,"9":0.4956,"10":0.7243,"11":1.0},"4":{"0":0.0,"1":0.0,"2":0.0001333333,"3":0.0022666667,"4":0.0059,"5":0.0105333333,"6":0.0591666667,"7":0.1578,"8":0.2964333333,"9":0.4950666667,"10":0.7237,"11":1.0},"5":{"0":0.0,"1":0.0,"2":0.0000666667,"3":0.0021333333,"4":0.0057,"5":0.0102666667,"6":0.0588333333,"7":0.1574,"8":0.2959666667,"9":0.4945333333,"10":0.7231,"11":1.0},"6":{"0":0.0,"1":0.0,"2":0.0,"3":0.002,"4":0.0055,"5":0.01,"6":0.0585,"7":0.157,"8":0.2955,"9":0.494,"10":0.7225,"11":1.0},"7":{"0":0.0,"1":0.0,"2":0.0,"3":0.0015,"4":0.0045,"5":0.0085,"6":0.0565,"7":0.1545,"8":0.2925,"9":0.4905,"10":0.7185,"11":1.0},"8":{"0":0.0,"1":0.0,"2":0.0,"3":0.001,"4":0.0035,"5":0.007,"6":0.0545,"7":0.152,"8":0.2895,"9":0.487,"10":0.7145,"11":1.0},"9":{"0":0.0,"1":0.0,"2":0.0,"3":0.0005,"4":0.0025,"5":0.0055,"6":0.0525,"7":0.1495,"8":0.2865,"9":0.4835,"10":0.7105,"11":1.0},"10":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0015,"5":0.004,"6":0.0505,"7":0.147,"8":0.2835,"9":0.48,"10":0.7065,"11":1.0},"11":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0012,"5":0.0034,"6":0.0496,"7":0.1458,"8":0.282,"9":0.4782,"10":0.7044,"11":1.0},"12":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0009,"5":0.0028,"6":0.0487,"7":0.1446,"8":0.2805,"9":0.4764,"10":0.7023,"11":1.0},"13":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0006,"5":0.0022,"6":0.0478,"7":0.1434,"8":0.279,"9":0.4746,"10":0.7002,"11":1.0},"14":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0003,"5":0.0016,"6":0.0469,"7":0.1422,"8":0.2775,"9":0.4728,"10":0.6981,"11":1.0},"15":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.001,"6":0.046,"7":0.141,"8":0.276,"9":0.471,"10":0.696,"11":1.0},"16":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0008,"6":0.0456,"7":0.1404,"8":0.2752,"9":0.47,"10":0.6948,"11":1.0},"17":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0006,"6":0.0452,"7":0.1398,"8":0.2744,"9":0.469,"10":0.6936,"11":1.0},"18":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0004,"6":0.0448,"7":0.1392,"8":0.2736,"9":0.468,"10":0.6924,"11":1.0},"19":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0002,"6":0.0444,"7":0.1386,"8":0.2728,"9":0.467,"10":0.6912,"11":1.0},"20":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.044,"7":0.138,"8":0.272,"9":0.466,"10":0.69,"11":1.0},"21":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0396,"7":0.1292,"8":0.2588,"9":0.4484,"10":0.668,"11":1.0},"22":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0352,"7":0.1204,"8":0.2456,"9":0.4308,"10":0.646,"11":1.0},"23":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0308,"7":0.1116,"8":0.2324,"9":0.4132,"10":0.624,"11":1.0},"24":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0264,"7":0.1028,"8":0.2192,"9":0.3956,"10":0.602,"11":1.0},"25":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.022,"7":0.094,"8":0.206,"9":0.378,"10":0.58,"11":1.0},"26":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0176,"7":0.0852,"8":0.1928,"9":0.3604,"10":0.558,"11":1.0},"27":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0132,"7":0.0764,"8":0.1796,"9":0.3428,"10":0.536,"11":1.0},"28":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0088,"7":0.0676,"8":0.1664,"9":0.3252,"10":0.514,"11":1.0},"29":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0044,"7":0.0588,"8":0.1532,"9":0.3076,"10":0.492,"11":1.0},"30":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.05,"8":0.14,"9":0.29,"10":0.47,"11":1.0},"31":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.045,"8":0.13,"9":0.275,"10":0.45,"11":1.0},"32":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.04,"8":0.12,"9":0.26,"10":0.43,"11":1.0},"33":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.035,"8":0.11,"9":0.245,"10":0.41,"11":1.0},"34":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.03,"8":0.1,"9":0.23,"10":0.39,"11":1.0},"35":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.025,"8":0.09,"9":0.215,"10":0.37,"11":1.0},"36":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.02,"8":0.08,"9":0.2,"10":0.35,"11":1.0},"37":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.015,"8":0.07,"9":0.185,"10":0.33,"11":1.0},"38":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.01,"8":0.06,"9":0.17,"10":0.31,"11":1.0},"39":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.005,"8":0.05,"9":0.155,"10":0.29,"11":1.0},"40":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.04,"9":0.14,"10":0.27,"11":1.0},"41":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0373333333,"9":0.1346666667,"10":0.262,"11":1.0},"42":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0346666667,"9":0.1293333333,"10":0.254,"11":1.0},"43":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.032,"9":0.124,"10":0.246,"11":1.0},"44":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0293333333,"9":0.1186666667,"10":0.238,"11":1.0},"45":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0266666667,"9":0.1133333333,"10":0.23,"11":1.0},"46":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.024,"9":0.108,"10":0.222,"11":1.0},"47":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0213333333,"9":0.1026666667,"10":0.214,"11":1.0},"48":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0186666667,"9":0.0973333333,"10":0.206,"11":1.0},"49":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.016,"9":0.092,"10":0.198,"11":1.0},"50":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0133333333,"9":0.0866666667,"10":0.19,"11":1.0},"51":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0106666667,"9":0.0813333333,"10":0.182,"11":1.0},"52":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.008,"9":0.076,"10":0.174,"11":1.0},"53":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0053333333,"9":0.0706666667,"10":0.166,"11":1.0},"54":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0026666667,"9":0.0653333333,"10":0.158,"11":1.0},"55":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.06,"10":0.15,"11":1.0},"56":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.056,"10":0.142,"11":1.0},"57":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.052,"10":0.134,"11":1.0},"58":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.048,"10":0.126,"11":1.0},"59":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.044,"10":0.118,"11":1.0},"60":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.04,"10":0.11,"11":1.0},"61":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.036,"10":0.102,"11":1.0},"62":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.032,"10":0.094,"11":1.0},"63":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.028,"10":0.086,"11":1.0},"64":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.024,"10":0.078,"11":1.0},"65":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.02,"10":0.07,"11":1.0},"66":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.016,"10":0.062,"11":1.0},"67":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.012,"10":0.054,"11":1.0},"68":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.008,"10":0.046,"11":1.0},"69":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.004,"10":0.038,"11":1.0},"70":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.03,"11":1.0},"71":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0288,"11":1.0},"72":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0276,"11":1.0},"73":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0264,"11":1.0},"74":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0252,"11":1.0},"75":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.024,"11":1.0},"76":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0228,"11":1.0},"77":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0216,"11":1.0},"78":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0204,"11":1.0},"79":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0192,"11":1.0},"80":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.018,"11":1.0},"81":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0168,"11":1.0},"82":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0156,"11":1.0},"83":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0144,"11":1.0},"84":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0132,"11":1.0},"85":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.012,"11":1.0},"86":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0108,"11":1.0},"87":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0096,"11":1.0},"88":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0084,"11":1.0},"89":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0072,"11":1.0},"90":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.006,"11":1.0},"91":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0048,"11":1.0},"92":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0036,"11":1.0},"93":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0024,"11":1.0},"94":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0012,"11":1.0},"95":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":1.0},"96":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":1.0},"97":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":1.0},"98":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":1.0}}

const golden_prob_choice:{[n:string]:{[index:string]:number}} ={"1":{"0":0.0001,"1":0.00026,"2":0.00044,"3":0.00084,"4":0.00164,"5":0.00364,"6":0.03364,"7":0.10364,"8":0.20864,"9":0.40864,"10":0.64864,"11":1.0},"2":{"0":0.0,"1":0.00003,"2":0.00008,"3":0.00035,"4":0.00102,"5":0.00289,"6":0.03276,"7":0.10263,"8":0.2075,"9":0.40737,"10":0.64724,"11":1.0},"3":{"0":0.0,"1":0.0,"2":0.00002,"3":0.00026,"4":0.0009,"5":0.00274,"6":0.03258,"7":0.10242,"8":0.20726,"9":0.4071,"10":0.64694,"11":1.0},"4":{"0":0.0,"1":0.0,"2":0.0000133333,"3":0.0002466667,"4":0.00088,"5":0.0027133333,"6":0.0325466667,"7":0.10238,"8":0.2072133333,"9":0.4070466667,"10":0.64688,"11":1.0},"5":{"0":0.0,"1":0.0,"2":0.0000066667,"3":0.0002333333,"4":0.00086,"5":0.0026866667,"6":0.0325133333,"7":0.10234,"8":0.2071666667,"9":0.4069933333,"10":0.64682,"11":1.0},"6":{"0":0.0,"1":0.0,"2":0.0,"3":0.00022,"4":0.00084,"5":0.00266,"6":0.03248,"7":0.1023,"8":0.20712,"9":0.40694,"10":0.64676,"11":1.0},"7":{"0":0.0,"1":0.0,"2":0.0,"3":0.000165,"4":0.00073,"5":0.002495,"6":0.03226,"7":0.102025,"8":0.20679,"9":0.406555,"10":0.64632,"11":1.0},"8":{"0":0.0,"1":0.0,"2":0.0,"3":0.00011,"4":0.00062,"5":0.00233,"6":0.03204,"7":0.10175,"8":0.20646,"9":0.40617,"10":0.64588,"11":1.0},"9":{"0":0.0,"1":0.0,"2":0.0,"3":0.000055,"4":0.00051,"5":0.002165,"6":0.03182,"7":0.101475,"8":0.20613,"9":0.405785,"10":0.64544,"11":1.0},"10":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0004,"5":0.002,"6":0.0316,"7":0.1012,"8":0.2058,"9":0.4054,"10":0.645,"11":1.0},"11":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.00032,"5":0.00184,"6":0.03136,"7":0.10088,"8":0.2054,"9":0.40492,"10":0.64444,"11":1.0},"12":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.00024,"5":0.00168,"6":0.03112,"7":0.10056,"8":0.205,"9":0.40444,"10":0.64388,"11":1.0},"13":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.00016,"5":0.00152,"6":0.03088,"7":0.10024,"8":0.2046,"9":0.40396,"10":0.64332,"11":1.0},"14":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.00008,"5":0.00136,"6":0.03064,"7":0.09992,"8":0.2042,"9":0.40348,"10":0.64276,"11":1.0},"15":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0012,"6":0.0304,"7":0.0996,"8":0.2038,"9":0.403,"10":0.6422,"11":1.0},"16":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.00096,"6":0.02992,"7":0.09888,"8":0.20284,"9":0.4018,"10":0.64076,"11":1.0},"17":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.00072,"6":0.02944,"7":0.09816,"8":0.20188,"9":0.4006,"10":0.63932,"11":1.0},"18":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.00048,"6":0.02896,"7":0.09744,"8":0.20092,"9":0.3994,"10":0.63788,"11":1.0},"19":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.00024,"6":0.02848,"7":0.09672,"8":0.19996,"9":0.3982,"10":0.63644,"11":1.0},"20":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.028,"7":0.096,"8":0.199,"9":0.397,"10":0.635,"11":1.0},"21":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0224,"7":0.0848,"8":0.1822,"9":0.3746,"10":0.607,"11":1.0},"22":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0168,"7":0.0736,"8":0.1654,"9":0.3522,"10":0.579,"11":1.0},"23":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0112,"7":0.0624,"8":0.1486,"9":0.3298,"10":0.551,"11":1.0},"24":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0056,"7":0.0512,"8":0.1318,"9":0.3074,"10":0.523,"11":1.0},"25":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.04,"8":0.115,"9":0.285,"10":0.495,"11":1.0},"26":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.032,"8":0.099,"9":0.261,"10":0.463,"11":1.0},"27":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.024,"8":0.083,"9":0.237,"10":0.431,"11":1.0},"28":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.016,"8":0.067,"9":0.213,"10":0.399,"11":1.0},"29":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.008,"8":0.051,"9":0.189,"10":0.367,"11":1.0},"30":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.035,"9":0.165,"10":0.335,"11":1.0},"31":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.028,"9":0.151,"10":0.314,"11":1.0},"32":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.021,"9":0.137,"10":0.293,"11":1.0},"33":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.014,"9":0.123,"10":0.272,"11":1.0},"34":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.007,"9":0.109,"10":0.251,"11":1.0},"35":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.095,"10":0.23,"11":1.0},"36":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.076,"10":0.192,"11":1.0},"37":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.057,"10":0.154,"11":1.0},"38":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.038,"10":0.116,"11":1.0},"39":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.019,"10":0.078,"11":1.0},"40":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.04,"11":1.0},"41":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.032,"11":1.0},"42":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.024,"11":1.0},"43":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.016,"11":1.0},"44":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.008,"11":1.0},"45":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":1.0},"46":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":1.0},"47":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":1.0},"48":{"0":0.0,"1":0.0,"2":0.0,"3":0.0,"4":0.0,"5":0.0,"6":0.0,"7":0.0,"8":0.0,"9":0.0,"10":0.0,"11":1.0}}

const items: string[] = ['Paranium',
    'Pythium',
    'Crypton',
    'Onixius',
    'Gem',
    'Metal',
    'Crystal',
    'Plastic',
    'Rubber',
    'Wood',
    'Stone',
    'Soil'];


//generate seed
const seedGenerator = (address: string, unbox_blockhash: string, boxId: number, n: number = 0, turn: number=0): string => {
    if (turn < 0 || turn > 2) throw new Error(`turn must be 0|1|2`)
    const hmac = HmacSHA256(`${address}:${unbox_blockhash}:${boxId}:${turn.toString()}`, n.toString());
    return hmac.toString(enc.Hex);
}

//generate box quantity n1,n2,n3
const getQuantityBox = (address: string, unbox_blockhash: string, boxId: number, box_type: number): number[] => {
    if (box_type < 0 || box_type > 2 || typeof box_type !== 'number' || !Number.isInteger(box_type)) throw new Error(`box_type must be 0|1|2`)    
    const quantity_max = box_type === 0 ? 50 : (box_type === 1 ? 70 : 100)
    const results: number[] = []
    let max_mod_arr:number[]=[quantity_max-20-10*box_type-1]; // 30 40 60
    let bound_number_arr :number[]=[40,60,70]; 
    let turn = 0 //turn
    let n = 0

    while (turn >= 0 && turn <= 2) {
        const seed = seedGenerator(address, unbox_blockhash, boxId, n, turn)
        if(turn==1){
            max_mod_arr.push(bound_number_arr[box_type] - results[0]); // 10 10 10
        }
        else if(turn==2){
            max_mod_arr.push(quantity_max-results[0]-results[1]); // 10 20 30
            
            
        }
        const max_mod = max_mod_arr[turn];
        n = new Decimal(`0x` + seed).mod(max_mod).toNumber() +1;
        n = n === 0 ? 1 : n
        results.push(n)
       
        turn += 1
    }
    return results
}


//get random number from 1 to 100.000
function randomInt(address: string, unbox_blockhash: string, boxId: number, turn: number,rd_max:number) {
    let rd_seed = seedGenerator(address, unbox_blockhash, boxId, turn);
   
    let rd_num = new Decimal(`0x` + rd_seed).mod(rd_max).toNumber() ;
    return rd_num;
}


function getBoxItem(n:number,address: string, unbox_blockhash: string, boxId: number, turn: number,box_type:number,item_rs:number[]): number[] {
    if (box_type < 0 || box_type > 2 || typeof box_type !== 'number' || !Number.isInteger(box_type)) throw new Error(`boxType must be 0|1|2`);

    if (n < 1 || typeof n !== 'number' || !Number.isInteger(n)) throw new Error("quantityRunes must be a integer greater or equal 1")
    let rdNumber: number = randomInt(address, unbox_blockhash, boxId, turn,100001) / 100000;
    let w: {[index:string]:number} ,i = 0;
    if(box_type==0){
        w=golden_prob_choice[n.toString()]
    }else if(box_type==1){
        w=platinum_prob_choice[n.toString()]
    }else{
        w=diamond_prob_choice[n.toString()]
    }
    for (i; i < 12; i++)
        if (w[i.toString()] >= rdNumber)
            break;
    item_rs[i]+=n;
    return item_rs;
    
}




function openBox(address: string, unbox_blockhash: string, boxId: number, box_type: number) {
    let item_rs:number[]=new Array(12).fill(0)
    let box: string, arr_n: number[];
    if (box_type == 0) {
        box = 'Golden'
        arr_n = getQuantityBox(address, unbox_blockhash, boxId, box_type)


        item_rs = getBoxItem(arr_n[0], address,unbox_blockhash, boxId, 1, box_type,item_rs);

        item_rs = getBoxItem(arr_n[1], address,unbox_blockhash, boxId, 2, box_type,item_rs);

        item_rs = getBoxItem(arr_n[2], address,unbox_blockhash, boxId, 3, box_type,item_rs);


    } else if (box_type == 1) {
        box = 'Platinum'
        arr_n = getQuantityBox(address, unbox_blockhash, boxId, box_type)


        item_rs = getBoxItem(arr_n[0], address,unbox_blockhash, boxId, 1, box_type,item_rs);

        item_rs = getBoxItem(arr_n[1], address,unbox_blockhash, boxId, 2, box_type,item_rs);

        item_rs = getBoxItem(arr_n[2], address,unbox_blockhash, boxId, 3, box_type,item_rs);

    } else {
        box = 'Diamond'
        arr_n = getQuantityBox(address, unbox_blockhash, boxId, box_type)


        item_rs = getBoxItem(arr_n[0], address,unbox_blockhash, boxId, 1, box_type,item_rs);

        item_rs = getBoxItem(arr_n[1], address,unbox_blockhash, boxId, 2, box_type,item_rs);

        item_rs = getBoxItem(arr_n[2], address,unbox_blockhash, boxId, 3, box_type,item_rs);

    }
    return {'result': boxId + ' | '+ box+ item_rs.reverse().reduce((a, b) => a.toString() +' | ' + b, '') };
}




const createCsvWriter = require('csv-writer').createObjectCsvWriter;
const csvWriter = createCsvWriter({
    path: 'p5kNew.csv',
    header: [
        
        { id: 'result', title: 'result' },
       
    ]
});

var rs_array: any[] = [];
for (let i = 8500; i < 10000; i++) {
    const address = `0x${randomBytes(20).toString('hex')}`
    const unbox_blockhash = `0x${randomBytes(32).toString('hex')}`
    rs_array.push(openBox(address, unbox_blockhash, i, 2));
}


csvWriter
    .writeRecords(rs_array)
    .then(() => console.log('The CSV file was written successfully'));
